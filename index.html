<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- åŠ å…¥é€™è¡Œè®“æ‰‹æ©Ÿç€è¦½æ­£å¸¸ç¸®æ”¾ -->
  <title>æ´»å‹•è³‡è¨ŠæŸ¥è©¢ç³»çµ±</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 16px;
      margin: 0;
      background-color: #f5f5f5;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      font-size: 22px;
      margin-bottom: 12px;
      text-align: center;
    }
    input, button {
      padding: 12px;
      margin: 8px 0;
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    #result {
      margin-top: 20px;
      font-weight: bold;
      white-space: pre-wrap;
      background: #f0f0f0;
      padding: 15px;
      border-radius: 5px;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>æ´»å‹•è³‡è¨ŠæŸ¥è©¢</h2>
  <p>è«‹è¼¸å…¥ <strong>å“¡å·¥ç·¨è™Ÿ</strong>ã€<strong>ä¸­æ–‡å§“å</strong> æˆ– <strong>è‹±æ–‡å§“å</strong>ï¼š</p>
  <input type="text" id="searchInput" placeholder="ä¾‹å¦‚ï¼šA12345 æˆ– ç‹å°æ˜ æˆ– Ming Wang">
  <button onclick="search()">æŸ¥è©¢</button>

  <div id="result">è³‡æ–™è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</div>
</div>

<script>
  let data = [];

  const sheetId = '1w4e0JW8HWC5TgpqYNv3O8lEyg7NnywNo67qgwCZC1d4';
  const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;

  fetch(sheetURL)
    .then(res => res.text())
    .then(rep => {
      const json = JSON.parse(rep.substr(47).slice(0, -2));
      const rows = json.table.rows;
      data = rows.map(row => ({
        cname: row.c[0]?.v?.trim() || "",
        ename: row.c[1]?.v?.trim() || "",
        id: row.c[2]?.v?.trim() || "",
        dayGroup: row.c[3]?.v?.trim() || "",
        room: row.c[4]?.v?.trim() || "",
        dinnerTable: row.c[5]?.v?.trim() || ""
      }));
      document.getElementById('result').textContent = 'è«‹è¼¸å…¥è³‡æ–™æŸ¥è©¢ã€‚';
    })
    .catch(err => {
      console.error('è¼‰å…¥ Google Sheets å¤±æ•—', err);
      document.getElementById('result').textContent = 'è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèªè©¦ç®—è¡¨æ˜¯å¦è¨­ç‚ºå…¬é–‹ã€‚';
    });

  function search() {
    const input = document.getElementById("searchInput").value.trim().toLowerCase();
    const resultDiv = document.getElementById("result");

    if (input === "") {
      resultDiv.textContent = "âŒ è«‹è¼¸å…¥æŸ¥è©¢æ¢ä»¶ï¼";
      return;
    }

    const person = data.find(p =>
      p.id.toLowerCase() === input ||
      p.cname.toLowerCase() === input ||
      p.ename.toLowerCase() === input
    );

    if (person) {
      resultDiv.textContent =
        `âœ”ï¸ æŸ¥è©¢æˆåŠŸï¼š
ä¸­æ–‡å§“åï¼š${person.cname}
è‹±æ–‡å§“åï¼š${person.ename}
å“¡å·¥ç·¨è™Ÿï¼š${person.id}

ğŸ•‘ ç™½å¤©çµ„åˆ¥ï¼š${person.dayGroup}
ğŸ¢ æœƒè­°å®¤ï¼š${person.room}
ğŸ½ï¸ æ™šå®´æ¡Œæ¬¡ï¼š${person.dinnerTable}`;
    } else {
      resultDiv.textContent = "âŒ æŸ¥ç„¡è³‡æ–™ï¼Œè«‹ç¢ºèªè¼¸å…¥æ˜¯å¦æ­£ç¢ºã€‚";
    }
  }
</script>

</body>
</html>