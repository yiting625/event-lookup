<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.3">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-TW"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;活動資訊查詢系統&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>input, button { padding: 8px; margin: 5px 0; font-size: 16px; width: 100%; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>#result { margin-top: 20px; font-weight: bold; white-space: pre-wrap; background: #f8f8f8; padding: 15px; border-radius: 5px; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;h2&gt;活動資訊查詢&lt;/h2&gt;</p>
<p class="p1">&lt;p&gt;請輸入 &lt;strong&gt;員工編號&lt;/strong&gt;、&lt;strong&gt;中文姓名&lt;/strong&gt; 或 &lt;strong&gt;英文姓名&lt;/strong&gt;：&lt;/p&gt;</p>
<p class="p1">&lt;input type="text" id="searchInput" placeholder="例如：A12345 或 王小明 或 Ming Wang"&gt;</p>
<p class="p1">&lt;button onclick="search()"&gt;查詢&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div id="result"&gt;資料載入中，請稍候...&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>let data = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const sheetId = '1w4e0JW8HWC5TgpqYNv3O8lEyg7NnywNo67qgwCZC1d4';</p>
<p class="p1"><span class="Apple-converted-space">  </span>const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>fetch(sheetURL)</p>
<p class="p1"><span class="Apple-converted-space">    </span>.then(res =&gt; res.text())</p>
<p class="p1"><span class="Apple-converted-space">    </span>.then(rep =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const json = JSON.parse(rep.substr(47).slice(0, -2));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rows = json.table.rows;</p>
<p class="p1"><span class="Apple-converted-space">      </span>data = rows.map(row =&gt; ({</p>
<p class="p1"><span class="Apple-converted-space">        </span>cname: row.c[0]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">        </span>ename: row.c[1]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">        </span>id: row.c[2]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">        </span>dayGroup: row.c[3]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">        </span>room: row.c[4]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">        </span>dinnerTable: row.c[5]?.v?.trim() || ""</p>
<p class="p1"><span class="Apple-converted-space">      </span>}));</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('result').textContent = '請輸入資料查詢。';</p>
<p class="p1"><span class="Apple-converted-space">    </span>})</p>
<p class="p1"><span class="Apple-converted-space">    </span>.catch(err =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>console.error('載入 Google Sheets 失敗', err);</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('result').textContent = '資料載入失敗，請確認試算表是否設為公開。';</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function search() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const input = document.getElementById("searchInput").value.trim().toLowerCase();</p>
<p class="p1"><span class="Apple-converted-space">    </span>const resultDiv = document.getElementById("result");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const person = data.find(p =&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.id.toLowerCase() === input ||</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.cname.toLowerCase() === input ||</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.ename.toLowerCase() === input</p>
<p class="p1"><span class="Apple-converted-space">    </span>);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (person) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>resultDiv.textContent =</p>
<p class="p1"><span class="Apple-converted-space">        </span>`✔️ 查詢成功：</p>
<p class="p1">中文姓名：${person.cname}</p>
<p class="p1">英文姓名：${person.ename}</p>
<p class="p1">員工編號：${person.id}</p>
<p class="p2"><br></p>
<p class="p1">🕑 白天組別：${person.dayGroup}</p>
<p class="p1">🏢 會議室：${person.room}</p>
<p class="p1">🍽️ 晚宴桌次：${person.dinnerTable}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">      </span>resultDiv.textContent = "❌ 查無資料，請確認輸入是否正確。";</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
