<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.3">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-TW"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;æ´»å‹•è³‡è¨ŠæŸ¥è©¢ç³»çµ±&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>input, button { padding: 8px; margin: 5px 0; font-size: 16px; width: 100%; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>#result { margin-top: 20px; font-weight: bold; white-space: pre-wrap; background: #f8f8f8; padding: 15px; border-radius: 5px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;h2&gt;æ´»å‹•è³‡è¨ŠæŸ¥è©¢&lt;/h2&gt;</p>
<p class="p1">&lt;p&gt;è«‹è¼¸å…¥ &lt;strong&gt;å“¡å·¥ç·¨è™Ÿ&lt;/strong&gt;ã€&lt;strong&gt;ä¸­æ–‡å§“å&lt;/strong&gt; æˆ– &lt;strong&gt;è‹±æ–‡å§“å&lt;/strong&gt;ï¼š&lt;/p&gt;</p>
<p class="p1">&lt;input type="text" id="searchInput" placeholder="ä¾‹å¦‚ï¼šA12345 æˆ– ç‹å°æ˜ æˆ– Ming Wang"&gt;</p>
<p class="p1">&lt;button onclick="search()"&gt;æŸ¥è©¢&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div id="result"&gt;è³‡æ–™è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let data = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const sheetId = '1w4e0JW8HWC5TgpqYNv3O8lEyg7NnywNo67qgwCZC1d4';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>fetch(sheetURL)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.then(res =&gt; res.text())</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.then(rep =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const json = JSON.parse(rep.substr(47).slice(0, -2));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const rows = json.table.rows;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>data = rows.map(row =&gt; ({</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>cname: row.c[0]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ename: row.c[1]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>id: row.c[2]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>dayGroup: row.c[3]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>room: row.c[4]?.v?.trim() || "",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>dinnerTable: row.c[5]?.v?.trim() || ""</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('result').textContent = 'è«‹è¼¸å…¥è³‡æ–™æŸ¥è©¢ã€‚';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>})</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.catch(err =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>console.error('è¼‰å…¥ Google Sheets å¤±æ•—', err);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('result').textContent = 'è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèªè©¦ç®—è¡¨æ˜¯å¦è¨­ç‚ºå…¬é–‹ã€‚';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function search() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const input = document.getElementById("searchInput").value.trim().toLowerCase();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const resultDiv = document.getElementById("result");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const person = data.find(p =&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>p.id.toLowerCase() === input ||</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>p.cname.toLowerCase() === input ||</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>p.ename.toLowerCase() === input</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (person) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>resultDiv.textContent =</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`âœ”ï¸ æŸ¥è©¢æˆåŠŸï¼š</p>
<p class="p1">ä¸­æ–‡å§“åï¼š${person.cname}</p>
<p class="p1">è‹±æ–‡å§“åï¼š${person.ename}</p>
<p class="p1">å“¡å·¥ç·¨è™Ÿï¼š${person.id}</p>
<p class="p2"><br></p>
<p class="p1">ğŸ•‘ ç™½å¤©çµ„åˆ¥ï¼š${person.dayGroup}</p>
<p class="p1">ğŸ¢ æœƒè­°å®¤ï¼š${person.room}</p>
<p class="p1">ğŸ½ï¸ æ™šå®´æ¡Œæ¬¡ï¼š${person.dinnerTable}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>resultDiv.textContent = "âŒ æŸ¥ç„¡è³‡æ–™ï¼Œè«‹ç¢ºèªè¼¸å…¥æ˜¯å¦æ­£ç¢ºã€‚";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
